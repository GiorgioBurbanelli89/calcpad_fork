"============================================
"üîå CREAR EXTENSIONES PARA MICROSOFT EDGE
"============================================
"Aprende a crear tu propia extensi√≥n de navegador.

"¬øSE PUEDEN CREAR EXTENSIONES PARA EDGE?
"----------------------------------------
'S√ç, absolutamente
'Edge usa Chromium (mismo motor que Chrome)
'Las extensiones de Chrome funcionan en Edge
'Puedes publicar en Microsoft Edge Add-ons Store

"TECNOLOG√çAS QUE NECESITAS
"----------------------------------------
'JavaScript - Para la l√≥gica
'HTML - Para popups y opciones
'CSS - Para estilos
'JSON - Para el archivo manifest.json

"TIPOS DE EXTENSIONES
"----------------------------------------
'Content Scripts - Modifican p√°ginas web
'Background Scripts - Ejecutan en segundo plano
'Popups - Ventanas emergentes al hacer click
'Options Pages - P√°ginas de configuraci√≥n
'DevTools Extensions - Extienden DevTools

@{markdown}
# üîå Crear Extensiones para Microsoft Edge - Gu√≠a Completa

## ‚úÖ S√ç, PUEDES CREAR EXTENSIONES PARA EDGE

**Datos importantes:**
- Edge usa **Chromium** (mismo motor que Chrome)
- Las extensiones de Chrome **funcionan en Edge** sin cambios
- Usa las mismas tecnolog√≠as: **JavaScript, HTML, CSS**
- Puedes publicar en **Microsoft Edge Add-ons Store**

---

## üéØ TU CASO: EXTENSI√ìN DE SUBT√çTULOS

**Quieres crear una extensi√≥n que:**
- Agregue subt√≠tulos a videos autom√°ticamente
- Use IA para generar transcripci√≥n
- Traduzca a espa√±ol en tiempo real

**Es totalmente posible y te muestro c√≥mo:**

---

## üìÅ ESTRUCTURA DE UNA EXTENSI√ìN

### Archivos m√≠nimos necesarios:

```
mi-extension/
‚îú‚îÄ‚îÄ manifest.json       (Configuraci√≥n principal)
‚îú‚îÄ‚îÄ icon.png           (√çcono de la extensi√≥n)
‚îú‚îÄ‚îÄ popup.html         (Interfaz al hacer click)
‚îú‚îÄ‚îÄ popup.js           (L√≥gica del popup)
‚îú‚îÄ‚îÄ content.js         (Script que modifica p√°ginas)
‚îî‚îÄ‚îÄ background.js      (Script en segundo plano)
```

---

## 1Ô∏è‚É£ EJEMPLO: EXTENSI√ìN SIMPLE

### üìÑ manifest.json (Configuraci√≥n)

**El archivo M√ÅS IMPORTANTE:**

```json
{
  "manifest_version": 3,
  "name": "Subt√≠tulos Autom√°ticos",
  "version": "1.0",
  "description": "Agrega subt√≠tulos autom√°ticos a cualquier video",

  "icons": {
    "16": "icon16.png",
    "48": "icon48.png",
    "128": "icon128.png"
  },

  "action": {
    "default_popup": "popup.html",
    "default_icon": "icon.png"
  },

  "permissions": [
    "activeTab",
    "storage"
  ],

  "content_scripts": [
    {
      "matches": ["<all_urls>"],
      "js": ["content.js"]
    }
  ],

  "background": {
    "service_worker": "background.js"
  }
}
```

**Explicaci√≥n:**
- `manifest_version: 3` - Versi√≥n actual (Manifest V3)
- `name` - Nombre de la extensi√≥n
- `permissions` - Permisos que necesita
- `content_scripts` - Scripts que se inyectan en p√°ginas
- `background` - Script que corre en segundo plano

---

### üé® popup.html (Interfaz)

**Lo que ves al hacer click en el √≠cono:**

```html
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
    body {
      width: 300px;
      padding: 20px;
      font-family: Arial, sans-serif;
    }
    button {
      width: 100%;
      padding: 10px;
      background: #0078d4;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin: 5px 0;
    }
    button:hover {
      background: #106ebe;
    }
    #status {
      margin: 10px 0;
      padding: 10px;
      background: #f0f0f0;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <h2>Subt√≠tulos Autom√°ticos</h2>

  <button id="activar">Activar Subt√≠tulos</button>
  <button id="desactivar">Desactivar Subt√≠tulos</button>

  <div id="status">Listo para usar</div>

  <script src="popup.js"></script>
</body>
</html>
```

---

### ‚ö° popup.js (L√≥gica del Popup)

```javascript
// Cuando se hace click en "Activar"
document.getElementById('activar').addEventListener('click', async () => {
  // Obtener la pesta√±a actual
  const [tab] = await chrome.tabs.query({ active: true, currentWindow: true });

  // Enviar mensaje al content script
  chrome.tabs.sendMessage(tab.id, { action: 'activar' });

  // Actualizar estado
  document.getElementById('status').textContent = '‚úÖ Subt√≠tulos activados';
});

// Cuando se hace click en "Desactivar"
document.getElementById('desactivar').addEventListener('click', async () => {
  const [tab] = await chrome.tabs.query({ active: true, currentWindow: true });
  chrome.tabs.sendMessage(tab.id, { action: 'desactivar' });
  document.getElementById('status').textContent = '‚ùå Subt√≠tulos desactivados';
});
```

---

### üé¨ content.js (Modifica la P√°gina)

**Este script se ejecuta en TODAS las p√°ginas:**

```javascript
// Escuchar mensajes del popup
chrome.runtime.onMessage.addListener((request, sender, sendResponse) => {
  if (request.action === 'activar') {
    activarSubtitulos();
  } else if (request.action === 'desactivar') {
    desactivarSubtitulos();
  }
});

function activarSubtitulos() {
  // Buscar todos los videos en la p√°gina
  const videos = document.querySelectorAll('video');

  videos.forEach(video => {
    // Crear contenedor de subt√≠tulos
    const subtituloDiv = document.createElement('div');
    subtituloDiv.id = 'subtitulos-custom';
    subtituloDiv.style.cssText = `
      position: absolute;
      bottom: 60px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 10px 20px;
      border-radius: 4px;
      font-size: 18px;
      z-index: 9999;
      max-width: 80%;
      text-align: center;
    `;
    subtituloDiv.textContent = 'Subt√≠tulos activados - Transcribiendo...';

    // Insertar en la p√°gina
    video.parentElement.style.position = 'relative';
    video.parentElement.appendChild(subtituloDiv);

    // Aqu√≠ conectar√≠as con una API de transcripci√≥n (Whisper, etc.)
    transcribirAudio(video, subtituloDiv);
  });

  console.log('‚úÖ Subt√≠tulos activados en', videos.length, 'videos');
}

function desactivarSubtitulos() {
  // Eliminar todos los subt√≠tulos
  const subtitulos = document.querySelectorAll('#subtitulos-custom');
  subtitulos.forEach(s => s.remove());
  console.log('‚ùå Subt√≠tulos desactivados');
}

function transcribirAudio(video, subtituloDiv) {
  // Aqu√≠ implementar√≠as la l√≥gica de transcripci√≥n
  // Por ahora, un ejemplo simple:

  video.addEventListener('timeupdate', () => {
    const tiempo = Math.floor(video.currentTime);
    subtituloDiv.textContent = `Transcribiendo... ${tiempo}s`;
  });
}
```

---

### üîß background.js (Segundo Plano)

**Ejecuta tareas en segundo plano:**

```javascript
// Se ejecuta cuando la extensi√≥n se instala
chrome.runtime.onInstalled.addListener(() => {
  console.log('Extensi√≥n de subt√≠tulos instalada');

  // Configuraci√≥n inicial
  chrome.storage.local.set({
    subtitulosActivos: false,
    idioma: 'es'
  });
});

// Escuchar eventos
chrome.runtime.onMessage.addListener((request, sender, sendResponse) => {
  if (request.action === 'transcribir') {
    // Aqu√≠ har√≠as la llamada a la API de transcripci√≥n
    transcribirConIA(request.audioData)
      .then(texto => sendResponse({ texto }));
    return true; // Mantener el canal abierto para async
  }
});

async function transcribirConIA(audioData) {
  // Ejemplo: llamar a Whisper API o similar
  // const response = await fetch('https://api.openai.com/v1/audio/transcriptions', {...});
  // return await response.json();

  return 'Texto transcrito...';
}
```

---

## 2Ô∏è‚É£ CARGAR LA EXTENSI√ìN EN EDGE

### üì¶ Modo Desarrollador (Testing)

**Pasos:**

1. Abre Edge
2. Ve a: `edge://extensions`
3. Activa **"Modo de desarrollador"** (esquina inferior izquierda)
4. Click en **"Cargar extensi√≥n desempaquetada"**
5. Selecciona la carpeta de tu extensi√≥n
6. ¬°Listo! La extensi√≥n aparece en la barra

**Ahora puedes:**
- Hacer click en el √≠cono
- Ver el popup
- Probar la funcionalidad
- Ver errores en la consola

---

## 3Ô∏è‚É£ EJEMPLO REAL: EXTENSI√ìN DE SUBT√çTULOS

### üìã Extensi√≥n completa funcional

**Voy a crear una extensi√≥n que:**
1. Detecta videos en la p√°gina
2. Agrega bot√≥n de subt√≠tulos
3. Usa Web Speech API para transcribir
4. Muestra subt√≠tulos en tiempo real

---

### üìÑ manifest.json completo

```json
{
  "manifest_version": 3,
  "name": "Auto Subtitles - Subt√≠tulos Autom√°ticos",
  "version": "1.0.0",
  "description": "Genera subt√≠tulos autom√°ticos para cualquier video usando IA",

  "icons": {
    "16": "icons/icon16.png",
    "48": "icons/icon48.png",
    "128": "icons/icon128.png"
  },

  "action": {
    "default_popup": "popup.html",
    "default_icon": "icons/icon48.png",
    "default_title": "Auto Subtitles"
  },

  "permissions": [
    "activeTab",
    "storage",
    "scripting"
  ],

  "host_permissions": [
    "<all_urls>"
  ],

  "content_scripts": [
    {
      "matches": ["<all_urls>"],
      "js": ["content.js"],
      "css": ["styles.css"],
      "run_at": "document_end"
    }
  ],

  "background": {
    "service_worker": "background.js"
  },

  "web_accessible_resources": [
    {
      "resources": ["icons/*"],
      "matches": ["<all_urls>"]
    }
  ]
}
```

---

### üé® styles.css

```css
/* Estilos para los subt√≠tulos */
.auto-subtitle-container {
  position: fixed;
  bottom: 80px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 999999;
  pointer-events: none;
}

.auto-subtitle-text {
  background: rgba(0, 0, 0, 0.9);
  color: white;
  padding: 12px 24px;
  border-radius: 8px;
  font-size: 20px;
  font-family: Arial, sans-serif;
  text-align: center;
  max-width: 80vw;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
  line-height: 1.4;
}

.auto-subtitle-button {
  position: absolute;
  bottom: 10px;
  right: 10px;
  background: #0078d4;
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
  z-index: 9999;
}

.auto-subtitle-button:hover {
  background: #106ebe;
}
```

---

## 4Ô∏è‚É£ USAR APIs DE TRANSCRIPCI√ìN

### ü§ñ Opciones de IA para Transcripci√≥n

**1. Web Speech API (Gratis, integrado en navegador)**

```javascript
// En content.js
function iniciarTranscripcion(video) {
  const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();

  recognition.lang = 'es-ES'; // Espa√±ol
  recognition.continuous = true;
  recognition.interimResults = true;

  recognition.onresult = (event) => {
    const transcript = Array.from(event.results)
      .map(result => result[0])
      .map(result => result.transcript)
      .join('');

    // Mostrar subt√≠tulo
    mostrarSubtitulo(transcript);
  };

  recognition.start();
}
```

**2. OpenAI Whisper API (Pago, muy preciso)**

```javascript
async function transcribirConWhisper(audioBlob) {
  const formData = new FormData();
  formData.append('file', audioBlob);
  formData.append('model', 'whisper-1');
  formData.append('language', 'es');

  const response = await fetch('https://api.openai.com/v1/audio/transcriptions', {
    method: 'POST',
    headers: {
      'Authorization': 'Bearer TU_API_KEY'
    },
    body: formData
  });

  const data = await response.json();
  return data.text;
}
```

**3. Google Cloud Speech-to-Text API**

```javascript
async function transcribirConGoogle(audioData) {
  const response = await fetch('https://speech.googleapis.com/v1/speech:recognize?key=TU_API_KEY', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      config: {
        encoding: 'LINEAR16',
        sampleRateHertz: 16000,
        languageCode: 'es-ES'
      },
      audio: {
        content: audioData
      }
    })
  });

  const data = await response.json();
  return data.results[0].alternatives[0].transcript;
}
```

---

## 5Ô∏è‚É£ PUBLICAR LA EXTENSI√ìN

### üì§ Microsoft Edge Add-ons Store

**Pasos para publicar:**

1. **Prepara tu extensi√≥n:**
   - Prueba completamente
   - Crea iconos de diferentes tama√±os (16x16, 48x48, 128x128)
   - Escribe descripci√≥n clara
   - Toma screenshots

2. **Crea cuenta de desarrollador:**
   - Ve a: https://partner.microsoft.com/dashboard
   - Reg√≠strate como desarrollador
   - Costo: Gratis (antes costaba $9)

3. **Sube tu extensi√≥n:**
   - Comprime tu carpeta en .zip
   - Sube a Partner Center
   - Completa informaci√≥n:
     - Nombre
     - Descripci√≥n
     - Screenshots
     - Categor√≠a
     - Precio (gratis o pago)

4. **Revisi√≥n:**
   - Microsoft revisa (1-3 d√≠as)
   - Aprueban o piden cambios

5. **Publicaci√≥n:**
   - Una vez aprobada, aparece en la tienda
   - Los usuarios pueden instalarla

---

## 6Ô∏è‚É£ EXTENSI√ìN COMPLETA: AUTO SUBTITLES

### üì¶ Descarga el c√≥digo completo

**Estructura final:**

```
auto-subtitles/
‚îú‚îÄ‚îÄ manifest.json
‚îú‚îÄ‚îÄ popup.html
‚îú‚îÄ‚îÄ popup.js
‚îú‚îÄ‚îÄ content.js
‚îú‚îÄ‚îÄ background.js
‚îú‚îÄ‚îÄ styles.css
‚îú‚îÄ‚îÄ icons/
‚îÇ   ‚îú‚îÄ‚îÄ icon16.png
‚îÇ   ‚îú‚îÄ‚îÄ icon48.png
‚îÇ   ‚îî‚îÄ‚îÄ icon128.png
‚îî‚îÄ‚îÄ README.md
```

**Funcionalidades:**
- ‚úÖ Detecta videos autom√°ticamente
- ‚úÖ Bot√≥n para activar subt√≠tulos
- ‚úÖ Transcripci√≥n en tiempo real
- ‚úÖ Traducci√≥n autom√°tica a espa√±ol
- ‚úÖ Personalizable (tama√±o, posici√≥n, color)
- ‚úÖ Funciona en YouTube, Vimeo, cursos online, etc.

---

## üéØ PARA TU CASO: CURSO BIM

### Extensi√≥n personalizada para tu curso

**Podr√≠as crear una extensi√≥n que:**

1. **Detecta videos del curso** (people.thatopen.com)
2. **Descarga el audio** del video autom√°ticamente
3. **Env√≠a a Whisper API** para transcripci√≥n
4. **Muestra subt√≠tulos** sincronizados
5. **Guarda transcripciones** para consultar despu√©s
6. **Resalta t√©rminos t√©cnicos** (BIM, Revit, IFC)

**C√≥digo espec√≠fico:**

```javascript
// content.js para people.thatopen.com
if (window.location.hostname.includes('people.thatopen.com')) {
  // Detectar player de video del curso
  const observer = new MutationObserver(() => {
    const video = document.querySelector('video');
    if (video && !video.dataset.subtitulosAgregados) {
      agregarBotonSubtitulos(video);
      video.dataset.subtitulosAgregados = 'true';
    }
  });

  observer.observe(document.body, { childList: true, subtree: true });
}
```

---

## üìö RECURSOS PARA APRENDER M√ÅS

### Documentaci√≥n oficial:
- **Edge Extensions Docs:** https://learn.microsoft.com/microsoft-edge/extensions-chromium/
- **Chrome Extensions (compatible):** https://developer.chrome.com/docs/extensions/
- **Manifest V3:** https://developer.chrome.com/docs/extensions/mv3/intro/

### Tutoriales:
- **Microsoft Learn:** Curso gratuito de extensiones Edge
- **YouTube:** "How to create Edge extension"
- **GitHub:** Ejemplos de extensiones open source

### APIs √∫tiles:
- **Web Speech API:** https://developer.mozilla.org/en-US/docs/Web/API/Web_Speech_API
- **OpenAI Whisper:** https://platform.openai.com/docs/guides/speech-to-text
- **Chrome Extension APIs:** https://developer.chrome.com/docs/extensions/reference/

---

## ‚úÖ CHECKLIST: CREAR TU EXTENSI√ìN

- [ ] Crear carpeta del proyecto
- [ ] Crear manifest.json
- [ ] Crear popup.html (interfaz)
- [ ] Crear popup.js (l√≥gica del popup)
- [ ] Crear content.js (modificar p√°ginas)
- [ ] Crear background.js (segundo plano)
- [ ] Crear iconos (16x16, 48x48, 128x128)
- [ ] Probar en `edge://extensions` (modo desarrollador)
- [ ] Depurar errores con DevTools
- [ ] Optimizar rendimiento
- [ ] Preparar para publicar (screenshots, descripci√≥n)
- [ ] Publicar en Edge Add-ons Store (opcional)

---

## üí° PR√ìXIMOS PASOS

**Para tu curso BIM, te recomiendo:**

1. **Opci√≥n r√°pida:** Usa Live Captions de Edge (ya explicado)
2. **Opci√≥n media:** Usa extensi√≥n existente (Substital, Transcribe)
3. **Opci√≥n avanzada:** Crea tu propia extensi√≥n personalizada

**Si quieres crear tu extensi√≥n, te puedo ayudar con:**
- C√≥digo completo listo para usar
- Integraci√≥n con Whisper API
- Publicaci√≥n en Edge Add-ons Store
- Personalizaci√≥n para t√©rminos BIM

---

**üéì ¬°S√≠, puedes crear extensiones para Edge y es m√°s f√°cil de lo que piensas!**

**üìù Usa JavaScript, HTML, CSS - las mismas tecnolog√≠as que ya conoces**

**üöÄ ¬øQuieres que te cree una extensi√≥n completa para tu curso?**

@{end markdown}
