"============================================
"ðŸŽ¨ P5.JS - CREATIVE CODING
"============================================
"Aprende a crear arte generativo y visualizaciones con p5.js.

"Â¿QUÃ‰ ES P5.JS?
"----------------------------------------
'Biblioteca JavaScript para arte generativo y creatividad
'Basada en Processing (lenguaje de arte visual)
'Muy fÃ¡cil de aprender
'Perfecta para: arte, animaciones, visualizaciones

"FUNCIONES PRINCIPALES
"----------------------------------------
'setup() - Se ejecuta una vez al inicio
'draw() - Se ejecuta ~60 veces por segundo
'createCanvas(w, h) - Crear lienzo
'background(color) - Fondo
'fill(color) - Color de relleno
'stroke(color) - Color de borde
'rect(), circle(), line() - Formas bÃ¡sicas

"INSTALACIÃ“N
"----------------------------------------
'<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>

@{html}
<!DOCTYPE html>
<html lang="es">

<!-- #region HEAD -->
<head>
  <meta charset="UTF-8">
  <title>18 - p5.js Creative Coding</title>

  <!-- #region ESTILOS -->
  <style>
    body {
      margin: 0;
      padding: 20px;
      font-family: Arial, sans-serif;
      background-color: #1a1a1a;
      color: white;
      text-align: center;
    }

    h1 {
      color: white;
    }

    .info {
      background: rgba(255,255,255,0.1);
      padding: 20px;
      max-width: 800px;
      margin: 20px auto;
      border-radius: 8px;
    }

    #canvas-container {
      display: flex;
      justify-content: center;
      margin: 20px 0;
    }
  </style>
  <!-- #endregion -->
</head>
<!-- #endregion -->

<!-- #region BODY -->
<body>
  <h1>ðŸŽ¨ p5.js - Creative Coding</h1>
  <p>Mueve el mouse sobre el canvas</p>

  <div id="canvas-container"></div>

  <div class="info">
    <h3>ðŸ’¡ CaracterÃ­sticas de este sketch:</h3>
    <ul style="text-align: left; max-width: 400px; margin: 0 auto;">
      <li>PartÃ­culas siguen al mouse</li>
      <li>Colores cambian con el movimiento</li>
      <li>Efecto de estela (fade)</li>
      <li>Click para cambiar el modo</li>
    </ul>
  </div>

  <!-- #region SCRIPTS -->
  <!-- Cargar p5.js desde CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>

  <script>
    // #region VARIABLES GLOBALES
    let particulas = [];
    let modo = 0;
    // #endregion

    // #region CLASE PARTÃCULA
    class Particula {
      constructor(x, y) {
        this.x = x;
        this.y = y;
        this.vx = random(-2, 2);
        this.vy = random(-2, 2);
        this.r = random(5, 15);
        this.color = color(random(255), random(255), random(255));
        this.vida = 255;
      }

      actualizar() {
        this.x += this.vx;
        this.y += this.vy;
        this.vida -= 2;
      }

      mostrar() {
        noStroke();
        fill(red(this.color), green(this.color), blue(this.color), this.vida);
        circle(this.x, this.y, this.r);
      }

      estaViva() {
        return this.vida > 0;
      }
    }
    // #endregion

    // #region SETUP - SE EJECUTA UNA VEZ
    function setup() {
      let canvas = createCanvas(800, 600);
      canvas.parent('canvas-container');
      background(20);
    }
    // #endregion

    // #region DRAW - SE EJECUTA ~60 FPS
    function draw() {
      // Efecto de fade
      background(20, 20, 20, 25);

      // Crear nueva partÃ­cula en posiciÃ³n del mouse
      if (mouseIsPressed || frameCount % 3 === 0) {
        if (modo === 0) {
          // Modo: partÃ­culas simples
          particulas.push(new Particula(mouseX, mouseY));
        } else if (modo === 1) {
          // Modo: cÃ­rculo de partÃ­culas
          let angulo = random(TWO_PI);
          let radio = 50;
          let x = mouseX + cos(angulo) * radio;
          let y = mouseY + sin(angulo) * radio;
          particulas.push(new Particula(x, y));
        } else if (modo === 2) {
          // Modo: lluvia de partÃ­culas
          let x = random(width);
          particulas.push(new Particula(x, 0));
        }
      }

      // Actualizar y mostrar partÃ­culas
      for (let i = particulas.length - 1; i >= 0; i--) {
        particulas[i].actualizar();
        particulas[i].mostrar();

        if (!particulas[i].estaViva()) {
          particulas.splice(i, 1);
        }
      }

      // Mostrar informaciÃ³n
      fill(255);
      noStroke();
      textAlign(LEFT);
      text(`Modo: ${modo + 1}/3`, 10, 20);
      text(`PartÃ­culas: ${particulas.length}`, 10, 40);
      text('Click para cambiar modo', 10, 60);
    }
    // #endregion

    // #region EVENTOS
    function mouseClicked() {
      modo = (modo + 1) % 3;
      particulas = [];
      return false;
    }
    // #endregion

    console.log('âœ… p5.js sketch cargado');
  </script>
  <!-- #endregion -->

  <!-- #region CÃ“DIGO DE EJEMPLO -->
  <div class="info">
    <h3>ðŸ’» CÃ³digo BÃ¡sico p5.js:</h3>
    <pre style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 4px; text-align: left;">
function setup() {
  createCanvas(400, 400);
  background(220);
}

function draw() {
  // Dibuja un cÃ­rculo en posiciÃ³n del mouse
  fill(255, 0, 0);
  circle(mouseX, mouseY, 50);
}
    </pre>
  </div>
  <!-- #endregion -->

</body>
<!-- #endregion -->

</html>
@{end html}
