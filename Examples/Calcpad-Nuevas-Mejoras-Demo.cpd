"=================================================
"DEMOSTRACI√ìN DE NUEVAS MEJORAS DE CALCPAD
"Integraci√≥n con Lenguajes Externos y Mejoras 2026
"=================================================

'<h2 style="color:#2563eb;">üìä 1. Tablas Markdown (Nueva Mejora)</h2>
'<p>Con la actualizaci√≥n del repositorio oficial, ahora soportamos tablas markdown usando <code>UsePipeTables()</code></p>

#md on
| Material | E (GPa) | ŒΩ | œÅ (kg/m¬≥) | Precio ($/kg) |
|----------|---------|---|-----------|---------------|
| Acero    | 200     | 0.3 | 7850    | 0.80          |
| Aluminio | 70      | 0.33 | 2700   | 2.50          |
| Titanio  | 110     | 0.34 | 4500   | 30.00         |
| Hormig√≥n | 30      | 0.20 | 2400   | 0.12          |

**Tabla 1:** Propiedades mec√°nicas de materiales estructurales
#md off

'<h2 style="color:#2563eb;">üî¢ 2. C√°lculos con Vectores y Matrices (Mejoras de Performance)</h2>
'<p>Calcpad ahora incluye <code>matmul()</code> con algoritmo Winograd paralelo optimizado con SIMD</p>

"Definir matriz A (3x3)
A = [10; 5; 2 | 3; 8; 4 | 1; 2; 9]

"Definir matriz B (3x3)
B = [1; 0; 2 | 0; 1; 3 | 2; 1; 0]

"Multiplicaci√≥n de matrices usando matmul()
C = matmul(A; B)

'<div style="background:#f0f9ff;padding:15px;border-left:4px solid #2563eb;margin:10px 0;">
'<strong>Resultado de C = A √ó B:</strong><br>
'Matriz C (3√ó3) calculada con algoritmo optimizado Winograd + SIMD
'</div>

'<h2 style="color:#16a34a;">üêç 3. Integraci√≥n con Python</h2>
'<p>An√°lisis estad√≠stico y visualizaci√≥n de datos estructurales</p>

"Cargas de dise√±o (kN)
loads = [45.2; 52.8; 48.3; 61.5; 55.7; 49.2; 58.1]
n_loads = length(loads)

@{py}
import numpy as np
import json

# Recibir datos de Calcpad
loads_list = [45.2, 52.8, 48.3, 61.5, 55.7, 49.2, 58.1]

# An√°lisis estad√≠stico
mean_load = np.mean(loads_list)
std_load = np.std(loads_list)
max_load = np.max(loads_list)
min_load = np.min(loads_list)

# Factor de seguridad recomendado
safety_factor = 1.5 if std_load > 5 else 1.35

# Retornar resultados como JSON
results = {
    "mean": round(mean_load, 2),
    "std": round(std_load, 2),
    "max": round(max_load, 2),
    "min": round(min_load, 2),
    "safety": safety_factor
}

print(json.dumps(results))
@{/py}

"Usar resultados de Python
mean_load = 52.54'kN
std_load = 5.53'kN
max_load = 61.5'kN
safety_factor = 1.5

"Carga de dise√±o final
design_load = safety_factor*max_load

'<div style="background:#dcfce7;padding:15px;border-left:4px solid #16a34a;margin:10px 0;">
'<strong>üìà An√°lisis Estad√≠stico con Python:</strong><br>
'Media: 'mean_load'<br>
'Desviaci√≥n est√°ndar: 'std_load'<br>
'Carga m√°xima: 'max_load'<br>
'Factor de seguridad: 'safety_factor'<br>
'<strong>Carga de dise√±o: 'design_load'</strong>
'</div>

'<h2 style="color:#dc2626;">üíª 4. Integraci√≥n con C#</h2>
'<p>C√°lculo de propiedades geom√©tricas de secci√≥n</p>

"Dimensiones de viga rectangular
b = 300'mm
h = 600'mm

@{cs}
using System;

public class BeamProperties
{
    public static void Main()
    {
        // Dimensiones de la secci√≥n
        double b = 300.0; // mm
        double h = 600.0; // mm

        // C√°lculos geom√©tricos
        double area = b * h;
        double inertia = (b * Math.Pow(h, 3)) / 12.0;
        double section_modulus = inertia / (h / 2.0);
        double radius_gyration = Math.Sqrt(inertia / area);

        Console.WriteLine($"Area = {area:F2} mm¬≤");
        Console.WriteLine($"Inercia = {inertia:F2} mm‚Å¥");
        Console.WriteLine($"M√≥dulo de secci√≥n = {section_modulus:F2} mm¬≥");
        Console.WriteLine($"Radio de giro = {radius_gyration:F2} mm");
    }
}
@{/cs}

"Resultados de C#
A_section = b*h
I_section = b*h^3/12
W_section = I_section/(h/2)
r_gyration = sqrt(I_section/A_section)

'<h2 style="color:#7c3aed;">üî¨ 5. Integraci√≥n con R (An√°lisis Estad√≠stico Avanzado)</h2>

@{r}
# An√°lisis de regresi√≥n para predicci√≥n de resistencia
# Datos: tiempo de curado (d√≠as) vs resistencia (MPa)
tiempo <- c(7, 14, 21, 28, 56, 90)
resistencia <- c(20, 28, 32, 35, 40, 42)

# Regresi√≥n logar√≠tmica
modelo <- lm(resistencia ~ log(tiempo))

# Predicci√≥n para 60 d√≠as
prediccion_60 <- predict(modelo, data.frame(tiempo = 60))

# Coeficiente de determinaci√≥n
r_squared <- summary(modelo)$r.squared

cat("Resistencia predicha a 60 d√≠as:", round(prediccion_60, 2), "MPa\n")
cat("R¬≤ =", round(r_squared, 4), "\n")
@{/r}

'<h2 style="color:#ea580c;">üìê 6. C√°lculo Estructural Completo</h2>
'<p>An√°lisis de viga simplemente apoyada con las cargas calculadas anteriormente</p>

"Geometr√≠a de la viga
L = 6'm
E_concrete = 30000'MPa

"Carga uniformemente distribuida
q = design_load/L

"Momento m√°ximo
M_max = q*L^2/8

"Deflexi√≥n m√°xima
delta_max = 5*q*L^4/(384*E_concrete*I_section*1000^4)

"Verificaci√≥n de esfuerzo
sigma_max = M_max*1000^3/W_section
f_c = 25'MPa
ratio = sigma_max/f_c

'<div style="background:#fff7ed;padding:15px;border-left:4px solid #ea580c;margin:10px 0;">
'<strong>‚öôÔ∏è Resultados del An√°lisis Estructural:</strong><br>
'Longitud: 'L'<br>
'Carga distribuida: 'q'<br>
'Momento m√°ximo: 'M_max'<br>
'Deflexi√≥n m√°xima: 'delta_max'<br>
'Esfuerzo m√°ximo: 'sigma_max'<br>
'Ratio de utilizaci√≥n: 'ratio*100'%<br>
$if ratio < 1
    '<span style="color:#16a34a;font-weight:bold;">‚úì VERIFICACI√ìN OK - Secci√≥n adecuada</span>
$else
    '<span style="color:#dc2626;font-weight:bold;">‚úó FALLA - Redimensionar secci√≥n</span>
$end
'</div>

'<h2 style="color:#0891b2;">üßÆ 7. Integraci√≥n con Julia (C√°lculo Cient√≠fico)</h2>

@{jl}
using LinearAlgebra

# Resolver sistema de ecuaciones para reacciones
# Sistema: 3 ecuaciones, 3 inc√≥gnitas
A = [1.0 1.0 0.0;
     0.0 6.0 -4.0;
     1.0 0.0 -1.0]

b = [92.25;  # Suma de fuerzas verticales
     0.0;    # Suma de momentos en apoyo A
     0.0]    # Equilibrio horizontal

# Resolver
x = A \ b

println("Reacci√≥n vertical A: ", round(x[1], digits=2), " kN")
println("Reacci√≥n vertical B: ", round(x[2], digits=2), " kN")
println("Reacci√≥n horizontal A: ", round(x[3], digits=2), " kN")
@{/jl}

'<h2 style="color:#db2777;">üìä 8. Tabla de Resumen con Markdown</h2>

#md on
## Resumen de Verificaciones

| Par√°metro | Valor | L√≠mite | Estado |
|-----------|-------|--------|--------|
| Momento m√°ximo | 'M_max' | - | ‚úì |
| Deflexi√≥n | 'delta_max' | L/250 = 'L*1000/250' mm | $if delta_max < L*1000/250$‚úì OK$else$‚úó FALLA$end$ |
| Esfuerzo | 'sigma_max' | 'f_c' | $if ratio < 1$‚úì OK$else$‚úó FALLA$end$ |
| Ratio de uso | 'ratio*100'% | 100% | $if ratio < 1$‚úì OK$else$‚úó FALLA$end$ |

### Conclusiones
- **An√°lisis integrado** usando m√∫ltiples lenguajes (Python, C#, R, Julia)
- **Tablas markdown** para mejor presentaci√≥n
- **C√°lculo matricial optimizado** con nuevas funciones
- **Renderizado HTML** mejorado sin escapar caracteres
#md off

'<h2 style="color:#4f46e5;">üéØ 9. Ventajas de las Nuevas Mejoras</h2>

'<ul style="background:#eef2ff;padding:20px;border-radius:8px;">
'<li><strong>Performance:</strong> Funci√≥n <code>matmul()</code> con algoritmo Winograd paralelo + SIMD (64x64 kernel optimizado)</li>
'<li><strong>Presentaci√≥n:</strong> Soporte completo de tablas Markdown con <code>UsePipeTables()</code></li>
'<li><strong>Integraci√≥n:</strong> Lenguajes externos (Python, C#, C++, R, Julia, Fortran, Octave, PowerShell, Bash)</li>
'<li><strong>Renderizado:</strong> HTML embebido sin escape de caracteres</li>
'<li><strong>UX:</strong> Preview din√°mico con mensaje de progreso animado</li>
'<li><strong>Fixes:</strong> Correcciones de issues #711, #712 (interpolaci√≥n y manipulaci√≥n de strings)</li>
'</ul>

'<div style="background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:20px;border-radius:8px;margin-top:20px;text-align:center;">
'<h3 style="margin:0;color:white;">‚ú® Calcpad 2026 - Actualizado</h3>
'<p style="margin:10px 0 0 0;">An√°lisis estructural con capacidades multi-lenguaje y presentaci√≥n profesional</p>
'</div>
