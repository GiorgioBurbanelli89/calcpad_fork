"============================================
"ANIMACIONES - Parte 1: Conceptos B√°sicos
"============================================
"Aprende qu√© es una animaci√≥n y c√≥mo funciona

"EXPLICACI√ìN:
"Una animaci√≥n es simplemente CAMBIAR algo en cada frame
"
"Frame = Una imagen de la animaci√≥n
"FPS (Frames Por Segundo) = Velocidad de la animaci√≥n
"  - 30 FPS = 30 im√°genes por segundo
"  - 60 FPS = 60 im√°genes por segundo (m√°s suave)
"
"requestAnimationFrame() = Funci√≥n que se ejecuta cada frame
"  (aproximadamente 60 veces por segundo)

@{html}
<style>
  .explicacion {
    background: #e3f2fd;
    padding: 20px;
    border-left: 4px solid #2196f3;
    margin: 20px 0;
  }

  .codigo-ejemplo {
    background: #f5f5f5;
    padding: 15px;
    border-radius: 4px;
    font-family: monospace;
    margin: 10px 0;
  }
</style>

<div class="explicacion">
  <h3>üé¨ ¬øQu√© es una Animaci√≥n?</h3>
  <p>
    Una animaci√≥n es como un <strong>flipbook</strong> (libro de animaci√≥n):
    <br>- Cada p√°gina es ligeramente diferente
    <br>- Al pasar las p√°ginas r√°pido, parece que se mueve
  </p>
</div>

<!-- EJEMPLO 1: Cuadrado que se mueve horizontalmente -->
<h3>Ejemplo 1: Cuadrado Movi√©ndose</h3>
<canvas id="canvas1" width="600" height="100" style="border: 2px solid #ccc;"></canvas>

<script>
  // ===================================================================
  // EJEMPLO 1: ANIMACI√ìN SIMPLE
  // ===================================================================

  // 1. Obtener el canvas (√°rea de dibujo)
  const canvas1 = document.getElementById('canvas1');
  const ctx1 = canvas1.getContext('2d');

  // 2. Variables de estado
  let posX = 0;  // Posici√≥n X del cuadrado
  const velocidad = 2;  // P√≠xeles por frame

  // 3. Funci√≥n que dibuja un frame
  function dibujarFrame1() {
    // Limpiar el canvas (borrar todo)
    ctx1.clearRect(0, 0, canvas1.width, canvas1.height);

    // Dibujar el cuadrado en la nueva posici√≥n
    ctx1.fillStyle = '#4caf50';  // Color verde
    ctx1.fillRect(posX, 30, 40, 40);  // (x, y, ancho, alto)

    // Mover el cuadrado
    posX += velocidad;

    // Si sale de la pantalla, volver al inicio
    if (posX > canvas1.width) {
      posX = -40;  // Empezar antes del borde izquierdo
    }

    // 4. Llamar de nuevo esta funci√≥n en el siguiente frame
    requestAnimationFrame(dibujarFrame1);
  }

  // 5. Iniciar la animaci√≥n
  dibujarFrame1();
</script>

<div class="explicacion">
  <h4>üí° Explicaci√≥n del C√≥digo:</h4>
  <div class="codigo-ejemplo">
    1. ctx.clearRect() ‚Üí Borra todo el canvas<br>
    2. ctx.fillRect() ‚Üí Dibuja un rect√°ngulo<br>
    3. posX += velocidad ‚Üí Aumenta la posici√≥n<br>
    4. requestAnimationFrame() ‚Üí Llama la funci√≥n otra vez
  </div>
</div>

<!-- EJEMPLO 2: Cuadrado que sube y baja -->
<h3>Ejemplo 2: Movimiento Vertical (Seno)</h3>
<canvas id="canvas2" width="600" height="150" style="border: 2px solid #ccc;"></canvas>
<p>FPS: <span id="fps2">0</span> | Frames: <span id="frames2">0</span></p>

<script>
  // ===================================================================
  // EJEMPLO 2: MOVIMIENTO SINUSOIDAL
  // ===================================================================

  const canvas2 = document.getElementById('canvas2');
  const ctx2 = canvas2.getContext('2d');

  let tiempo = 0;  // Variable de tiempo
  let frameCount2 = 0;
  let lastTime2 = performance.now();

  function dibujarFrame2() {
    // Limpiar
    ctx2.clearRect(0, 0, canvas2.width, canvas2.height);

    // Calcular posici√≥n Y usando seno
    // Math.sin() da valores entre -1 y 1
    const posY = 75 + Math.sin(tiempo) * 40;
    //         ‚Üë              ‚Üë           ‚Üë
    //      centro      oscilaci√≥n    amplitud

    // Dibujar c√≠rculo
    ctx2.fillStyle = '#2196f3';
    ctx2.beginPath();
    ctx2.arc(300, posY, 20, 0, Math.PI * 2);  // (x, y, radio, inicio, fin)
    ctx2.fill();

    // Dibujar l√≠nea de referencia (centro)
    ctx2.strokeStyle = '#ccc';
    ctx2.setLineDash([5, 5]);  // L√≠nea punteada
    ctx2.beginPath();
    ctx2.moveTo(0, 75);
    ctx2.lineTo(600, 75);
    ctx2.stroke();
    ctx2.setLineDash([]);  // Volver a l√≠nea s√≥lida

    // Incrementar tiempo
    tiempo += 0.05;  // Velocidad de oscilaci√≥n

    // Calcular FPS
    frameCount2++;
    const currentTime2 = performance.now();
    if (currentTime2 - lastTime2 >= 1000) {  // Cada segundo
      document.getElementById('fps2').textContent = frameCount2;
      frameCount2 = 0;
      lastTime2 = currentTime2;
    }
    document.getElementById('frames2').textContent = Math.floor(tiempo / 0.05);

    requestAnimationFrame(dibujarFrame2);
  }

  dibujarFrame2();
</script>

<div class="explicacion">
  <h4>üìä Math.sin() para Movimientos Suaves:</h4>
  <p>
    <code>Math.sin(tiempo)</code> crea movimiento de onda:
    <br>‚Ä¢ Cuando tiempo = 0 ‚Üí sin = 0 (centro)
    <br>‚Ä¢ Cuando tiempo = œÄ/2 ‚Üí sin = 1 (arriba)
    <br>‚Ä¢ Cuando tiempo = œÄ ‚Üí sin = 0 (centro)
    <br>‚Ä¢ Cuando tiempo = 3œÄ/2 ‚Üí sin = -1 (abajo)
  </p>
</div>

<!-- EJEMPLO 3: M√∫ltiples objetos -->
<h3>Ejemplo 3: M√∫ltiples Objetos Animados</h3>
<canvas id="canvas3" width="600" height="200" style="border: 2px solid #ccc;"></canvas>

<script>
  // ===================================================================
  // EJEMPLO 3: M√öLTIPLES OBJETOS
  // ===================================================================

  const canvas3 = document.getElementById('canvas3');
  const ctx3 = canvas3.getContext('2d');

  // Crear un array de c√≠rculos
  const circulos = [];
  for (let i = 0; i < 10; i++) {
    circulos.push({
      x: Math.random() * 600,      // Posici√≥n X aleatoria
      y: Math.random() * 200,      // Posici√≥n Y aleatoria
      vx: (Math.random() - 0.5) * 4,  // Velocidad X (-2 a +2)
      vy: (Math.random() - 0.5) * 4,  // Velocidad Y (-2 a +2)
      radio: 5 + Math.random() * 15,  // Radio aleatorio
      color: `hsl(${Math.random() * 360}, 70%, 60%)`  // Color aleatorio
    });
  }

  function dibujarFrame3() {
    // Limpiar
    ctx3.clearRect(0, 0, canvas3.width, canvas3.height);

    // Actualizar y dibujar cada c√≠rculo
    circulos.forEach(circulo => {
      // Mover
      circulo.x += circulo.vx;
      circulo.y += circulo.vy;

      // Rebotar en los bordes
      if (circulo.x - circulo.radio < 0 || circulo.x + circulo.radio > 600) {
        circulo.vx *= -1;  // Invertir direcci√≥n X
      }
      if (circulo.y - circulo.radio < 0 || circulo.y + circulo.radio > 200) {
        circulo.vy *= -1;  // Invertir direcci√≥n Y
      }

      // Dibujar
      ctx3.fillStyle = circulo.color;
      ctx3.beginPath();
      ctx3.arc(circulo.x, circulo.y, circulo.radio, 0, Math.PI * 2);
      ctx3.fill();
    });

    requestAnimationFrame(dibujarFrame3);
  }

  dibujarFrame3();
</script>

<div class="explicacion">
  <h4>üéØ Conceptos Clave:</h4>
  <ul>
    <li><strong>Array de objetos:</strong> Guardamos m√∫ltiples c√≠rculos en una lista</li>
    <li><strong>forEach():</strong> Recorre cada elemento del array</li>
    <li><strong>Rebote:</strong> Invertir velocidad cuando toca un borde</li>
    <li><strong>hsl():</strong> Sistema de color (Hue, Saturation, Lightness)</li>
  </ul>
</div>

<!-- EJEMPLO 4: Control manual -->
<h3>Ejemplo 4: Control con Botones</h3>
<canvas id="canvas4" width="600" height="150" style="border: 2px solid #ccc;"></canvas>
<div style="margin: 10px 0;">
  <button id="btnIniciar" style="padding: 10px 20px; margin: 5px; cursor: pointer; font-size: 16px;">‚ñ∂Ô∏è Iniciar</button>
  <button id="btnPausar" style="padding: 10px 20px; margin: 5px; cursor: pointer; font-size: 16px;">‚è∏Ô∏è Pausar</button>
  <button id="btnReiniciar" style="padding: 10px 20px; margin: 5px; cursor: pointer; font-size: 16px;">üîÑ Reiniciar</button>
  <br>
  <label>Velocidad: </label>
  <input type="range" id="velocidadSlider" min="1" max="10" value="3" style="width: 200px;">
  <span id="velocidadValor">3</span>x
</div>

<script>
  // ===================================================================
  // EJEMPLO 4: ANIMACI√ìN CONTROLABLE
  // ===================================================================

  const canvas4 = document.getElementById('canvas4');
  const ctx4 = canvas4.getContext('2d');

  let posX4 = 0;
  let velocidad4 = 3;
  let animando = false;  // Estado de la animaci√≥n

  function dibujarFrame4() {
    if (!animando) return;  // Si est√° pausado, no hacer nada

    ctx4.clearRect(0, 0, canvas4.width, canvas4.height);

    // Dibujar barra de progreso
    ctx4.fillStyle = '#4caf50';
    ctx4.fillRect(0, 60, posX4, 30);

    // Dibujar borde
    ctx4.strokeStyle = '#333';
    ctx4.strokeRect(0, 60, 600, 30);

    // Dibujar texto de porcentaje
    const porcentaje = Math.floor((posX4 / 600) * 100);
    ctx4.fillStyle = '#333';
    ctx4.font = 'bold 16px Arial';
    ctx4.textAlign = 'center';
    ctx4.fillText(porcentaje + '%', 300, 110);

    // Mover
    posX4 += velocidad4;

    // Si llega al final, detener
    if (posX4 >= 600) {
      posX4 = 600;
      animando = false;
    }

    if (animando) {
      requestAnimationFrame(dibujarFrame4);
    }
  }

  // Botones
  document.getElementById('btnIniciar').addEventListener('click', () => {
    if (posX4 >= 600) posX4 = 0;  // Si termin√≥, reiniciar
    animando = true;
    dibujarFrame4();
  });

  document.getElementById('btnPausar').addEventListener('click', () => {
    animando = false;
  });

  document.getElementById('btnReiniciar').addEventListener('click', () => {
    animando = false;
    posX4 = 0;
    ctx4.clearRect(0, 0, canvas4.width, canvas4.height);
    ctx4.strokeRect(0, 60, 600, 30);
    ctx4.fillStyle = '#333';
    ctx4.font = 'bold 16px Arial';
    ctx4.textAlign = 'center';
    ctx4.fillText('0%', 300, 110);
  });

  document.getElementById('velocidadSlider').addEventListener('input', (e) => {
    velocidad4 = parseInt(e.target.value);
    document.getElementById('velocidadValor').textContent = velocidad4;
  });

  // Dibujar estado inicial
  ctx4.strokeRect(0, 60, 600, 30);
  ctx4.fillStyle = '#333';
  ctx4.font = 'bold 16px Arial';
  ctx4.textAlign = 'center';
  ctx4.fillText('0%', 300, 110);
</script>

<div class="explicacion">
  <h4>üéÆ Interactividad:</h4>
  <ul>
    <li><strong>Variable de estado:</strong> <code>animando</code> controla si la animaci√≥n est√° activa</li>
    <li><strong>Event listeners:</strong> Detectan clicks en los botones</li>
    <li><strong>Slider:</strong> Permite ajustar la velocidad en tiempo real</li>
    <li><strong>Condicional:</strong> <code>if (!animando) return;</code> detiene la animaci√≥n</li>
  </ul>
</div>

<div class="explicacion" style="background: #fff3cd; border-left-color: #ffc107;">
  <h4>üìö Resumen:</h4>
  <p><strong>Los 3 pasos de toda animaci√≥n:</strong></p>
  <ol>
    <li><strong>Limpiar</strong> el canvas/escena</li>
    <li><strong>Actualizar</strong> las posiciones/valores</li>
    <li><strong>Dibujar</strong> el nuevo estado</li>
  </ol>
  <p>
    <code>requestAnimationFrame()</code> repite estos 3 pasos ~60 veces por segundo.
  </p>
  <p>
    <strong>Pr√≥ximo paso:</strong> Aplicar estos conceptos a Three.js üöÄ
  </p>
</div>
@{end html}

"RESUMEN DE CONCEPTOS:
"
"1. requestAnimationFrame(funci√≥n)
"   Llama la funci√≥n en el pr√≥ximo frame (~60 FPS)
"
"2. clearRect(x, y, ancho, alto)
"   Borra un √°rea del canvas
"
"3. fillRect(x, y, ancho, alto)
"   Dibuja un rect√°ngulo relleno
"
"4. arc(x, y, radio, inicio, fin)
"   Dibuja un c√≠rculo/arco
"
"5. Math.sin(x) y Math.cos(x)
"   Crean movimientos suaves/ondulatorios
"
"6. Arrays para m√∫ltiples objetos
"   Guardan muchos elementos animados
"
"7. Variables de estado (animando, pausado)
"   Controlan el flujo de la animaci√≥n
"
"Estos conceptos son la BASE de cualquier
"animaci√≥n, incluyendo Three.js
