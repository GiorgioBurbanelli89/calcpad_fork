<UserControl x:Class="Calcpad.Wpf.MathcadPrimeEditor.MathcadPrimeEditorControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:Calcpad.Wpf.MathcadPrimeEditor.Controls"
             Background="White"
             Focusable="True">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>  <!-- Toolbar -->
            <RowDefinition Height="*"/>      <!-- Canvas principal -->
            <RowDefinition Height="Auto"/>  <!-- Barra de estado -->
        </Grid.RowDefinitions>

        <!-- TOOLBAR -->
        <Border Grid.Row="0" Background="#F5F5F5" BorderBrush="#CCCCCC" BorderThickness="0,0,0,1" Padding="5">
            <StackPanel Orientation="Horizontal">
                <!-- Archivo -->
                <Button x:Name="NewButton" Click="NewButton_Click" ToolTip="Nuevo (Ctrl+N)" Width="32" Height="32" Margin="2">
                    <Path Data="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M13,3.5L18.5,9H13V3.5Z"
                          Fill="#1976D2" Stretch="Uniform" Width="16" Height="16"/>
                </Button>
                <Button x:Name="OpenButton" Click="OpenButton_Click" ToolTip="Abrir (Ctrl+O)" Width="32" Height="32" Margin="2">
                    <Path Data="M19,20H4C2.89,20 2,19.1 2,18V6C2,4.89 2.89,4 4,4H10L12,6H19A2,2 0 0,1 21,8H21L4,8V18L6.14,10H23.21L20.93,18.5C20.7,19.37 19.92,20 19,20Z"
                          Fill="#388E3C" Stretch="Uniform" Width="16" Height="16"/>
                </Button>
                <Button x:Name="SaveButton" Click="SaveButton_Click" ToolTip="Guardar (Ctrl+S)" Width="32" Height="32" Margin="2">
                    <Path Data="M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z"
                          Fill="#FFA000" Stretch="Uniform" Width="16" Height="16"/>
                </Button>

                <Separator Width="1" Margin="5,0"/>

                <!-- Insertar -->
                <TextBlock Text="Insertar:" VerticalAlignment="Center" Margin="5,0" FontSize="10" Foreground="#666"/>
                <Button x:Name="InsertTextButton" Click="InsertTextButton_Click" ToolTip="Región de Texto" Width="32" Height="32" Margin="2">
                    <Path Data="M18.5,4L19.66,8.35L18.7,8.61C18.25,7.74 17.79,6.87 17.26,6.43C16.73,6 16.11,6 15.5,6H13V16.5C13,17 13,17.5 13.33,17.75C13.67,18 14.33,18 15,18V19H9V18C9.67,18 10.33,18 10.67,17.75C11,17.5 11,17 11,16.5V6H8.5C7.89,6 7.27,6 6.74,6.43C6.21,6.87 5.75,7.74 5.3,8.61L4.34,8.35L5.5,4H18.5Z"
                          Fill="#5E35B1" Stretch="Uniform" Width="16" Height="16"/>
                </Button>
                <Button x:Name="InsertMathButton" Click="InsertMathButton_Click" ToolTip="Región Matemática" Width="32" Height="32" Margin="2">
                    <Path Data="M17,13H13V17H11V13H7V11H11V7H13V11H17M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"
                          Fill="#1976D2" Stretch="Uniform" Width="16" Height="16"/>
                </Button>
                <Button x:Name="InsertImageButton" Click="InsertImageButton_Click" ToolTip="Imagen" Width="32" Height="32" Margin="2">
                    <Path Data="M8.5,13.5L11,16.5L14.5,12L19,18H5M21,19V5C21,3.89 20.1,3 19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19Z"
                          Fill="#F57C00" Stretch="Uniform" Width="16" Height="16"/>
                </Button>

                <Separator Width="1" Margin="5,0"/>

                <!-- Vista -->
                <CheckBox x:Name="ShowGridCheckbox" Content="Rejilla" IsChecked="True" VerticalAlignment="Center"
                         Margin="5,0" FontSize="10" Checked="ShowGridCheckbox_CheckedChanged" Unchecked="ShowGridCheckbox_CheckedChanged"/>
                <CheckBox x:Name="SnapToGridCheckbox" Content="Ajustar" IsChecked="False" VerticalAlignment="Center"
                         Margin="5,0" FontSize="10" Checked="SnapToGridCheckbox_CheckedChanged" Unchecked="SnapToGridCheckbox_CheckedChanged"/>

                <Separator Width="1" Margin="5,0"/>

                <!-- Zoom -->
                <TextBlock Text="Zoom:" VerticalAlignment="Center" Margin="5,0" FontSize="10" Foreground="#666"/>
                <Button x:Name="ZoomOutButton" Content="−" Click="ZoomOutButton_Click" Width="24" Height="24" Margin="2" ToolTip="Alejar"/>
                <TextBlock x:Name="ZoomLevelText" Text="100%" VerticalAlignment="Center" Width="40" TextAlignment="Center" FontSize="10"/>
                <Button x:Name="ZoomInButton" Content="+" Click="ZoomInButton_Click" Width="24" Height="24" Margin="2" ToolTip="Acercar"/>
                <Button x:Name="ZoomResetButton" Content="100%" Click="ZoomResetButton_Click" Width="36" Height="24" Margin="2" FontSize="9" ToolTip="Restablecer"/>
            </StackPanel>
        </Border>

        <!-- CANVAS PRINCIPAL CON REJILLA -->
        <Border Grid.Row="1" BorderBrush="#CCCCCC" BorderThickness="1">
            <ScrollViewer x:Name="CanvasScrollViewer"
                         HorizontalScrollBarVisibility="Auto"
                         VerticalScrollBarVisibility="Auto"
                         Background="White">
                <local:GridCanvas x:Name="MathcadCanvas"
                                 Width="800" Height="1200"
                                 ShowGrid="True"
                                 GridSize="10"
                                 MajorGridSize="50"
                                 SnapToGrid="False"
                                 ZoomLevel="1.0"/>
            </ScrollViewer>
        </Border>

        <!-- BARRA DE ESTADO -->
        <Border Grid.Row="2" Background="#F5F5F5" BorderBrush="#CCCCCC" BorderThickness="0,1,0,0" Padding="5,3">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock x:Name="StatusText" Grid.Column="0" Text="Listo" FontSize="10" Foreground="#666" VerticalAlignment="Center"/>
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <TextBlock x:Name="RegionCountText" Text="Regiones: 0" FontSize="10" Foreground="#666" Margin="10,0" VerticalAlignment="Center"/>
                    <TextBlock x:Name="PositionText" Text="X: 0, Y: 0" FontSize="10" Foreground="#666" VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</UserControl>
